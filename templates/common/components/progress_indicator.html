<style>
    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        max-width: 800px;
    }

    .progress-indicator {
        display: flex;
        justify-content: center;
        gap: 1rem;
        padding-bottom: 20px;
        width: 100%;
    }

    .step {
        background-color: #2e3141;
        color: #b0b0b0;
        padding: 8px 16px;
        border-radius: 4px;
        font-size: 1rem;
        text-align: center;
        position: relative;
    }

    .step.active {
        background-color: #00d8d2;
        color: #ffffff;
    }

    [role="tooltip"] {
        background-color: #393b50;
        color: #ffffff;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 0.9rem;
        position: absolute;
        z-index: 1000;
        white-space: nowrap;
    }

    .tooltip {
        position: absolute;
        bottom: 125%;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0, 0, 0, 0.6);
        color: #ffffff;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s;
        z-index: 10;
    }

    .tooltip::before {
        content: '';
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        border-width: 5px;
        border-style: solid;
        border-color: rgba(0, 0, 0, 0.6) transparent transparent transparent;
    }

    .custom-tooltip {
        visibility: hidden;
        background-color: #333;
        color: #fff;
        text-align: center;
        padding: 5px;
        border-radius: 4px;
        position: absolute;
        z-index: 1;
        bottom: 100%;
        left: 50%;
        margin-left: -60px;
        opacity: 0;
        transition: opacity 0.3s;
        white-space: nowrap;
        font-size: 0.8rem;
        width: 120px;
    }

    .custom-tooltip::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #333 transparent transparent transparent;
    }

    .step.show-tooltip .custom-tooltip {
        visibility: visible;
        opacity: 1;
    }

    @keyframes shake {

        0%,
        100% {
            transform: translateX(0);
        }

        10%,
        30%,
        50%,
        70%,
        90% {
            transform: translateX(-7px);
        }

        20%,
        40%,
        60%,
        80% {
            transform: translateX(7px);
        }
    }

    .shake {
        animation: shake 0.6s cubic-bezier(.36, .07, .19, .97) both;
    }
</style>

<div class="container">
    <div class="progress-indicator">
        {% for step in steps %}
        <div class="step {% if forloop.counter == active_step %}active{% endif %}" data-tooltip="{{ step.tooltip }}">
            <span>{{ forloop.counter }}</span>
            <p>{{ step.title }}</p>
            <div class="custom-tooltip">{{ step.tooltip_message }}</div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    document.querySelectorAll('.step').forEach(step => {
        step.addEventListener('mouseenter', () => {
            const tooltipText = step.dataset.tooltip;
            const tooltip = document.createElement('div');
            tooltip.classList.add('tooltip');
            tooltip.textContent = tooltipText;
            step.appendChild(tooltip);
            setTimeout(() => {
                tooltip.style.opacity = '1';
            }, 50);
        });

        step.addEventListener('mouseleave', () => {
            const tooltip = step.querySelector('.tooltip');
            tooltip.style.opacity = '0';
            setTimeout(() => {
                step.removeChild(tooltip);
            }, 300);
        });
    });

    document.querySelectorAll('.step').forEach(step => {
        step.addEventListener('click', () => {
            if (!step.classList.contains('active')) {
                step.classList.add('shake');
                step.classList.add('show-tooltip');
                setTimeout(() => {
                    step.classList.remove('shake');
                }, 820);
                setTimeout(() => {
                    step.classList.remove('show-tooltip');
                }, 3000);
            }
        });
    });
</script>